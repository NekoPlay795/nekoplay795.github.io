<script>
  (function() {
    // Определяем userAgent
    const ua = navigator.userAgent || navigator.vendor || window.opera;
    const isAndroid = /android/i.test(ua);

    // Проверяем, откуда пришли (deepLinkPath мы кладём в sessionStorage через 404.html)
    const deepLinkPath = sessionStorage.getItem("deepLinkPath");

    if (isAndroid) {
      // Формируем intent-ссылку для открытия приложения
      const packageName = "daddysapps.nekoplay.nekoplay";
      const intentUrl = "intent://" + (deepLinkPath ? deepLinkPath.replace(/^\//, "") : "") +
        "#Intent;scheme=https;package=" + packageName + ";end";

      // Пробуем открыть приложение
      window.location = intentUrl;

      // Если не установлено → через таймаут редиректим в Google Play
      setTimeout(function() {
        window.location = "https://play.google.com/store/apps/details?id=" + packageName;
      }, 1500);
    } else {
      // Для десктопа или iOS можешь просто показать сайт или сообщение
      console.log("Открыто не с Android, fallback в веб-версию");
    }

    // Очистим deepLinkPath, чтобы не срабатывало повторно
    if (deepLinkPath) {
      sessionStorage.removeItem("deepLinkPath");
    }
  })();
</script>
